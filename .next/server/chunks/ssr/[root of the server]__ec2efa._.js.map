{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmedalghotmy/Documents/cursor3/src/components/Chat/ChatInterface.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport '@/styles/RealtimeChat.css';\n\nexport default function ChatInterface({ sessionToken }: { sessionToken: string }) {\n  const [messages, setMessages] = useState<any[]>([]);\n  const [inputText, setInputText] = useState('');\n  const [isSessionActive, setIsSessionActive] = useState(false);\n  const [selectedVoice, setSelectedVoice] = useState('alloy');\n  const webSocketRef = useRef<WebSocket | null>(null);\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement | null>(null);\n  const peerConnection = useRef<RTCPeerConnection | null>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const startSession = async () => {\n    try {\n      const pc = new RTCPeerConnection();\n      peerConnection.current = pc;\n      \n      const audioEl = document.createElement(\"audio\");\n      audioEl.autoplay = true;\n      pc.ontrack = e => audioEl.srcObject = e.streams[0];\n      audioRef.current = audioEl;\n\n      await navigator.mediaDevices.getUserMedia({ audio: true })\n        .then(stream => {\n          pc.addTrack(stream.getTracks()[0]);\n        });\n\n      const dc = pc.createDataChannel(\"oai-events\");\n      dc.addEventListener(\"message\", handleServerEvent);\n\n      await initializeConnection(pc, sessionToken);\n      setIsSessionActive(true);\n    } catch (error) {\n      console.error('Failed to start session:', error);\n    }\n  };\n\n  const endSession = () => {\n    peerConnection.current?.close();\n    if (audioRef.current) {\n      audioRef.current.srcObject = null;\n    }\n    setIsSessionActive(false);\n    setMessages([]);\n    // Add a session ended message\n    setMessages([{ role: 'system', content: 'SESSION ENDED' }]);\n  };\n\n  const handleServerEvent = (e: MessageEvent) => {\n    const event = JSON.parse(e.data);\n    switch (event.type) {\n      case \"response.text.delta\":\n        setMessages(prev => {\n          const newMessages = [...prev];\n          const lastMessage = newMessages[newMessages.length - 1];\n          if (lastMessage?.role === 'assistant') {\n            lastMessage.content += event.delta;\n          } else {\n            newMessages.push({\n              role: 'assistant',\n              content: event.delta\n            });\n          }\n          return newMessages;\n        });\n        break;\n    }\n  };\n\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!inputText.trim() || !webSocketRef.current) return;\n\n    // Add user message to chat\n    setMessages(prev => [...prev, { role: 'user', content: inputText }]);\n\n    const event = {\n      type: \"conversation.item.create\",\n      item: {\n        type: \"message\",\n        role: \"user\",\n        content: [{\n          type: \"input_text\",\n          text: inputText\n        }]\n      }\n    };\n\n    webSocketRef.current.send(JSON.stringify(event));\n    \n    const responseEvent = {\n      type: \"response.create\",\n      response: {\n        modalities: [\"text\", \"audio\"],\n        voice: selectedVoice\n      }\n    };\n\n    webSocketRef.current.send(JSON.stringify(responseEvent));\n    setInputText('');\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"flex justify-between items-center p-4 border-b\">\n        <h1 className=\"text-xl font-semibold\">Realtime</h1>\n        <div className=\"flex gap-2\">\n          <button\n            onClick={() => setMessages([])}\n            className=\"px-3 py-1 text-gray-600 hover:bg-gray-100 rounded\"\n          >\n            Clear\n          </button>\n          {!isSessionActive ? (\n            <button\n              onClick={startSession}\n              className=\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\"\n            >\n              Start session\n            </button>\n          ) : (\n            <button\n              onClick={endSession}\n              className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\n            >\n              End session\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"flex flex-1 overflow-hidden\">\n        <div className=\"realtime-chat flex-1\">\n          <div className=\"messages\">\n            {messages.map((msg, i) => (\n              <div key={i} className={`message ${msg.role}`}>\n                {msg.role === 'system' ? (\n                  <div className=\"text-center text-gray-500 my-2\">{msg.content}</div>\n                ) : (\n                  <div className=\"flex\">\n                    <span className=\"font-semibold mr-2\">{msg.role.toUpperCase()}:</span>\n                    <span>{msg.content}</span>\n                  </div>\n                )}\n              </div>\n            ))}\n            <div ref={messagesEndRef} />\n          </div>\n          \n          <form onSubmit={handleSendMessage} className=\"input-area\">\n            <input\n              type=\"text\"\n              value={inputText}\n              onChange={(e) => setInputText(e.target.value)}\n              placeholder=\"Type your message...\"\n              disabled={!isSessionActive}\n              className=\"w-full p-2 border rounded\"\n            />\n            <button \n              type=\"submit\" \n              disabled={!inputText.trim() || !isSessionActive}\n              className=\"mt-2 px-4 py-2 bg-blue-500 text-white rounded disabled:bg-gray-300\"\n            >\n              Send\n            </button>\n          </form>\n        </div>\n\n        <div className=\"settings-panel\">\n          <div>\n            <label className=\"block mb-2\">Voice</label>\n            <select \n              value={selectedVoice}\n              onChange={(e) => setSelectedVoice(e.target.value)}\n              className=\"voice-select\"\n            >\n              <option value=\"alloy\">Alloy</option>\n              <option value=\"echo\">Echo</option>\n              <option value=\"fable\">Fable</option>\n              <option value=\"onyx\">Onyx</option>\n              <option value=\"nova\">Nova</option>\n              <option value=\"shimmer\">Shimmer</option>\n            </select>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nasync function initializeConnection(pc: RTCPeerConnection, token: string) {\n  const offer = await pc.createOffer();\n  await pc.setLocalDescription(offer);\n\n  const baseUrl = \"https://api.openai.com/v1/realtime\";\n  const model = \"gpt-4o-realtime-preview-2024-12-17\";\n  \n  const response = await fetch(`${baseUrl}?model=${model}`, {\n    method: \"POST\",\n    body: offer.sdp,\n    headers: {\n      Authorization: `Bearer ${token}`,\n      \"Content-Type\": \"application/sdp\"\n    },\n  });\n\n  const answer = {\n    type: 'answer' as const,\n    sdp: await response.text()\n  };\n  \n  await pc.setRemoteDescription(answer);\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 414, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmedalghotmy/Documents/cursor3/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport ChatInterface from '@/components/Chat/ChatInterface';\n\nexport default function Home() {\n  const [sessionToken, setSessionToken] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // Get session token when page loads\n    fetch('/api/realtime-session')\n      .then(res => {\n        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);\n        return res.json();\n      })\n      .then(data => {\n        console.log('Received session data:', data);\n        if (data.client_secret?.value) {\n          setSessionToken(data.client_secret.value);\n        } else {\n          throw new Error('No token in response');\n        }\n      })\n      .catch(err => {\n        console.error('Error fetching session:', err);\n        setError(err.message);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      });\n  }, []);\n\n  if (error) {\n    return (\n      <div className=\"flex items-center justify-center h-screen text-red-500\">\n        Error: {error}\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900\"></div>\n        <span className=\"ml-2\">Loading session...</span>\n      </div>\n    );\n  }\n\n  return (\n    <main className=\"h-screen\">\n      {sessionToken ? (\n        <ChatInterface sessionToken={sessionToken} />\n      ) : (\n        <div className=\"flex items-center justify-center h-full text-red-500\">\n          No session token available\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;IACzD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,oCAAoC;QACpC,MAAM,yBACH,IAAI,CAAC,CAAA;YACJ,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,IAAI,MAAM,EAAE;YAChE,OAAO,IAAI,IAAI;QACjB,GACC,IAAI,CAAC,CAAA;YACJ,QAAQ,GAAG,CAAC,0BAA0B;YACtC,IAAI,KAAK,aAAa,EAAE,OAAO;gBAC7B,gBAAgB,KAAK,aAAa,CAAC,KAAK;YAC1C,OAAO;gBACL,MAAM,IAAI,MAAM;YAClB;QACF,GACC,KAAK,CAAC,CAAA;YACL,QAAQ,KAAK,CAAC,2BAA2B;YACzC,SAAS,IAAI,OAAO;QACtB,GACC,OAAO,CAAC;YACP,aAAa;QACf;IACJ,GAAG,EAAE;IAEL,IAAI,OAAO;QACT,qBACE,8OAAC;YAAI,WAAU;;gBAAyD;gBAC9D;;;;;;;IAGd;IAEA,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;;;;;8BACf,8OAAC;oBAAK,WAAU;8BAAO;;;;;;;;;;;;IAG7B;IAEA,qBACE,8OAAC;QAAK,WAAU;kBACb,6BACC,8OAAC,2IAAA,CAAA,UAAa;YAAC,cAAc;;;;;iCAE7B,8OAAC;YAAI,WAAU;sBAAuD;;;;;;;;;;;AAM9E"}},
    {"offset": {"line": 508, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 518, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmedalghotmy/Documents/cursor3/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":";AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,MAAQ;;AAEzC,OAAO;IACL,IAAIF,QAAQC,GAAG,CAACK,uBAA2B,EAAF;;IAQzC,OAAO;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1CJ,OAAOC,OAAO,GAAGC,QAAQ;QAC3B,OAAO,IAAIL,QAAQC,GAAG,CAACO,SAAS,EAAE;;QAIlC;IACF;AACF","ignoreList":[0]}},
    {"offset": {"line": 532, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmedalghotmy/Documents/cursor3/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,0HAAyBC,QAAQ,CACxD,YACD,CAACC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 539, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmedalghotmy/Documents/cursor3/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored['react-ssr'].React\n"],"names":["module","exports","require","vendored","React"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,0HAAyBC,QAAQ,CAAC,YAAY,CAACC,KAAK","ignoreList":[0]}},
    {"offset": {"line": 546, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}